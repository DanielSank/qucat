

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using qucat programmatically &mdash; qucat  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API documentation" href="../API/API.html" />
    <link rel="prev" title="Using qucat with the graphical circuit editor" href="transmon_LC_GUI.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> qucat
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing this project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="transmon_LC_GUI.html">Using qucat with the graphical circuit editor</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using qucat programmatically</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Building-the-circuit">Building the circuit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculating-circuit-parameters">Calculating circuit parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Eigen-frequencies">Eigen-frequencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Anharmonicity">Anharmonicity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Cross-Kerr-or-dispersive-shift">Cross-Kerr or dispersive shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Loss-rates">Loss rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#T_1-times"><span class="math notranslate nohighlight">\(T_1\)</span> times</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Hamiltonian,-and-further-analysis-with-QuTiP">Hamiltonian, and further analysis with QuTiP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Generating-a-Hamiltonian">Generating a Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Open-system-dynamics">Open-system dynamics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Sweeping-a-parameter:-the-avoided-crossing">Sweeping a parameter: the avoided crossing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../API/API.html">Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">qucat</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Using qucat programmatically</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/transmon_LC_programmatically.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Using-qucat-programmatically">
<h1>Using qucat programmatically<a class="headerlink" href="#Using-qucat-programmatically" title="Permalink to this headline">¶</a></h1>
<p>In this example we study a typical circuit QED system consisting of a transmon qubit coupled to a resonator.</p>
<p>The first step is to import the objects we will be needing from qucat.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import the circuit builder</span>
<span class="kn">from</span> <span class="nn">qucat</span> <span class="k">import</span> <span class="n">Network</span>
<span class="c1"># Import the circuit components</span>
<span class="kn">from</span> <span class="nn">qucat</span> <span class="k">import</span> <span class="n">L</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">R</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="section" id="Building-the-circuit">
<h2>Building the circuit<a class="headerlink" href="#Building-the-circuit" title="Permalink to this headline">¶</a></h2>
<p>Note that the components (<code class="docutils literal notranslate"><span class="pre">R</span></code>, <code class="docutils literal notranslate"><span class="pre">L</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">J</span></code>) accept node indexes as their two first arguments, here we will use the node <code class="docutils literal notranslate"><span class="pre">0</span></code> to designate ground. The last arguments should be a label (<code class="docutils literal notranslate"><span class="pre">str</span></code>) or a value (<code class="docutils literal notranslate"><span class="pre">float</span></code>) or both, the order in which these arguments are provided are unimportant.</p>
<p>For the moment, we will specify the value of all the components.</p>
<p><strong>Note: by default the junction is parametrized by its josephson inductance</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cir</span> <span class="o">=</span> <span class="n">Network</span><span class="p">([</span>
    <span class="n">C</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">100e-15</span><span class="p">),</span> <span class="c1"># Add a capacitor between nodes 0 and 1, with a value of 100fF</span>
    <span class="n">J</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">8e-9</span><span class="p">),</span> <span class="c1"># Add a josephson junction, the value is given as Josephson inductance</span>
    <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-15</span><span class="p">),</span> <span class="c1"># Add the coupling capacitor</span>
    <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">100e-15</span><span class="p">),</span> <span class="c1"># Add the resonator capacitor</span>
    <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">10e-9</span><span class="p">),</span> <span class="c1"># Add the resonator inductor</span>
    <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">1e6</span><span class="p">)</span> <span class="c1"># Add the resonator resistor</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<p>This implements the following circuit, where we have also indexed the nodes, and we have fixed the value of <span class="math notranslate nohighlight">\(L_J\)</span> to <code class="docutils literal notranslate"><span class="pre">8e-9</span></code> H</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;graphics/transmon_LC_programmatically_1.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_transmon_LC_programmatically_6_0.png" src="../_images/tutorials_transmon_LC_programmatically_6_0.png" />
</div>
</div>
<p>We now calculate the eigenfrequency, loss-rates, anharmonicity, and Kerr parameters of the circuit.</p>
<p>This can be done through the functions <code class="docutils literal notranslate"><span class="pre">eigenfrequencies</span></code>, <code class="docutils literal notranslate"><span class="pre">loss_rates</span></code>, <code class="docutils literal notranslate"><span class="pre">anharmonicities</span></code> and <code class="docutils literal notranslate"><span class="pre">kerr</span></code>, which return the specified quantities for each mode, <strong>ordered with increasing mode frequency</strong></p>
</div>
<div class="section" id="Calculating-circuit-parameters">
<h2>Calculating circuit parameters<a class="headerlink" href="#Calculating-circuit-parameters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Eigen-frequencies">
<h3>Eigen-frequencies<a class="headerlink" href="#Eigen-frequencies" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cir</span><span class="o">.</span><span class="n">eigenfrequencies</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([5.00696407e+09, 5.60042136e+09])
</pre></div>
</div>
</div>
<p>This will return a list of the normal modes of the circuit, we can see they are seperated in frequency by 600 MHz, but we still do not which corresponds to the transmon, and which to the resonator.</p>
<p>To distinquish the two, we can calculate the anharmonicities of each mode.</p>
</div>
<div class="section" id="Anharmonicity">
<h3>Anharmonicity<a class="headerlink" href="#Anharmonicity" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cir</span><span class="o">.</span><span class="n">anharmonicities</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([5.83759906e+02, 1.91131052e+08])
</pre></div>
</div>
</div>
<p>The first (lowest frequency) mode, has a very small anharmonicity, whilst the second, has an anharmonicity of 191 MHz. The highest frequency mode thus corresponds to the transmon.</p>
</div>
<div class="section" id="Cross-Kerr-or-dispersive-shift">
<h3>Cross-Kerr or dispersive shift<a class="headerlink" href="#Cross-Kerr-or-dispersive-shift" title="Permalink to this headline">¶</a></h3>
<p>In this regime of far detuning in frequency, the two modes will interact through a cross-Kerr or dispersive shift, which quantifies the amount by which one mode will shift if frequency if the other is populated with a photon.</p>
<p>We can access this by calculating the Kerr parameters <code class="docutils literal notranslate"><span class="pre">K</span></code>. In this two dimensional array, the components <code class="docutils literal notranslate"><span class="pre">K[i,j]</span></code> correspond to the cross-Kerr interaction of mode <code class="docutils literal notranslate"><span class="pre">i</span></code> with mode <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">K</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">kerr</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> kHz&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
668.06 kHz
</pre></div></div>
</div>
<p>From the above, we have found that the cross-Kerr interaction between these two modes is of about 670 kHz.</p>
<p>This should correspond to <span class="math notranslate nohighlight">\(2\sqrt{A_0A_1}\)</span> where <span class="math notranslate nohighlight">\(A_i\)</span> is the anharmonicity of mode <span class="math notranslate nohighlight">\(i\)</span>. Let’s check that:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">A</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">anharmonicities</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> kHz&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">1e3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
668.06 kHz
</pre></div></div>
</div>
</div>
<div class="section" id="Loss-rates">
<h3>Loss rates<a class="headerlink" href="#Loss-rates" title="Permalink to this headline">¶</a></h3>
<p>In the studied circuit, the only resistor is located in the resonator. In this regime of large frequency, detuning, we would thus expect the resonator to be more lossy than the transmon.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cir</span><span class="o">.</span><span class="n">loss_rates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([786052.42260112,   1920.57996169])
</pre></div>
</div>
</div>
</div>
<div class="section" id="T_1-times">
<h3><span class="math notranslate nohighlight">\(T_1\)</span> times<a class="headerlink" href="#T_1-times" title="Permalink to this headline">¶</a></h3>
<p>When converting these rates to <span class="math notranslate nohighlight">\(T_1\)</span> times, one should not forget the <span class="math notranslate nohighlight">\(2\pi\)</span> in the conversion</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">T_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">cir</span><span class="o">.</span><span class="n">loss_rates</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[2.02473701e-07 8.28681681e-05]
</pre></div></div>
</div>
<p>All these relevant parameters (frequency, dissipation, anharmonicity and Kerr parameters) can be computed using a single function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cir</span><span class="o">.</span><span class="n">f_k_A_chi</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(array([5.00696407e+09, 5.60042136e+09]),
 array([786052.42260112,   1920.57996169]),
 array([5.83759906e+02, 1.91131052e+08]),
 array([[5.83759906e+02, 6.68055821e+05],
        [6.68055821e+05, 1.91131052e+08]]))
</pre></div>
</div>
</div>
<p>Using the option <code class="docutils literal notranslate"><span class="pre">pretty_print</span> <span class="pre">=</span> <span class="pre">True</span></code> a more readable summary can be printed</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">chi</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">f_k_A_chi</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    mode |  freq.  |  diss.  |  anha.  |
       0 | 5.01 GHz | 786 kHz |  584 Hz |
       1 | 5.6 GHz | 1.92 kHz | 191 MHz |

Kerr coefficients
(diagonal = Kerr, off-diagonal = cross-Kerr)
    mode |    0    |    1    |
       0 |  584 Hz |         |
       1 | 668 kHz | 191 MHz |

</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Hamiltonian,-and-further-analysis-with-QuTiP">
<h2>Hamiltonian, and further analysis with QuTiP<a class="headerlink" href="#Hamiltonian,-and-further-analysis-with-QuTiP" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Generating-a-Hamiltonian">
<h3>Generating a Hamiltonian<a class="headerlink" href="#Generating-a-Hamiltonian" title="Permalink to this headline">¶</a></h3>
<p>The Hamiltonian of the circuit, with the non-linearity of the Josephson junctions Taylor-expanded, is given by</p>
<p><span class="math notranslate nohighlight">\(\hat{H} = \sum_{m\in\text{modes}} hf_m\hat{a}_m^\dagger\hat{a}_m +\sum_j\sum_{2n\le\text{taylor}}E_j\frac{(-1)^{n+1}}{(2n)!}\left(\frac{\phi_{zpf,m,j}}{\phi_0}(\hat{a}_m^\dagger+\hat{a}_m)\right)^{2n}\)</span></p>
<p>And in its construction, we have the freedom to choose the set of <code class="docutils literal notranslate"><span class="pre">modes</span></code> to include, the order of the Taylor expansion of the junction potential <code class="docutils literal notranslate"><span class="pre">taylor</span></code>, and the number of excitations of each mode to consider.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compute hamiltonian (for h=1, so all energies are expressed in frequency units, not angular)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">hamiltonian</span><span class="p">(</span>
    <span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="c1"># Include modes 0 and 1</span>
    <span class="n">taylor</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="c1"># Taylor the Josephson potential to the power 4</span>
    <span class="n">excitations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span><span class="c1"># Consider 8 excitations in mode 0, 10 for mode 1</span>

<span class="c1"># QuTiP method which return the eigenergies of the system</span>
<span class="n">ee</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenenergies</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The first transition of the resonator is</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2"> GHz&quot;</span><span class="o">%</span><span class="p">((</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">1e9</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5.006 GHz
</pre></div></div>
</div>
<p>and of the transmon</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2"> GHz&quot;</span><span class="o">%</span><span class="p">((</span><span class="n">ee</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">1e9</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5.394 GHz
</pre></div></div>
</div>
<p>Notice the difference, especially for the transmon, with the corresponding normal-mode frequency calculated above. This is a consequence of the zero-point fluctuations entering the junction and changing the effective transition frequency.</p>
<p>Following first-order perturbation, the shift in transition frequency can be estimated from the anharmonicity <span class="math notranslate nohighlight">\(A_1\)</span> and cross-kerr coupling <span class="math notranslate nohighlight">\(\chi_{0,1}\)</span> and should be given by <span class="math notranslate nohighlight">\(-A_1-\chi_{0,1}/2\)</span>. We see below that we get fairly close (7 MHz) from the value obtained from the hamiltonian diagonalization.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">K</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">f_k_A_chi</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2"> GHz&quot;</span><span class="o">%</span><span class="p">((</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">1e9</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5.409 GHz
</pre></div></div>
</div>
</div>
<div class="section" id="Open-system-dynamics">
<h3>Open-system dynamics<a class="headerlink" href="#Open-system-dynamics" title="Permalink to this headline">¶</a></h3>
<p>A more elaborate use of QuTiP would be to compute the dynamics (for example with qutip.mesolve). The Hamiltonian and collapse operators to use are</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># H is the Hamiltonian</span>
<span class="n">H</span><span class="p">,</span><span class="n">a_m_list</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="n">excitations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">return_ops</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># !!! which should be in angular frequencies for time-dependant simulations</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">H</span>

<span class="c1"># c_ops are the collapse operators</span>
<span class="c1"># !!! which should be in angular frequencies for time-dependant simulations</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">loss_rates</span><span class="p">()</span>
<span class="n">c_ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">a_m_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">a_m_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Sweeping-a-parameter:-the-avoided-crossing">
<h2>Sweeping a parameter: the avoided crossing<a class="headerlink" href="#Sweeping-a-parameter:-the-avoided-crossing" title="Permalink to this headline">¶</a></h2>
<p>The most computationally expensive part of the analysis is performed upon initializing the Network. To avoid doing this, we have the option to enter a symbolic value for a component.</p>
<p>We will only provide a label <code class="docutils literal notranslate"><span class="pre">L_J</span></code> for the junction here, and its value should be passed as a keyword argument in subsequent function calls, for example <code class="docutils literal notranslate"><span class="pre">L_J=1e-9</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cir</span> <span class="o">=</span> <span class="n">Network</span><span class="p">([</span>
    <span class="n">C</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">100e-15</span><span class="p">),</span>
    <span class="n">J</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;L_J&#39;</span><span class="p">),</span>
    <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-15</span><span class="p">),</span>
    <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">100e-15</span><span class="p">),</span>
    <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">10e-9</span><span class="p">),</span>
    <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">1e6</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<p>The implemented circuit, overlayed with the nodes, is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;graphics/transmon_LC_programmatically_1.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_transmon_LC_programmatically_47_0.png" src="../_images/tutorials_transmon_LC_programmatically_47_0.png" />
</div>
</div>
<p>Since the junction was created without a value, we now have to specify it as a keyword argument</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># array of values for the josephson inductance</span>
<span class="n">L_J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">8e-9</span><span class="p">,</span><span class="mf">12e-9</span><span class="p">,</span><span class="mi">1001</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">L_J</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span><span class="c1"># xaxis will be the inductance in units of nano-Henry</span>
    <span class="p">[</span><span class="n">cir</span><span class="o">.</span><span class="n">eigenfrequencies</span><span class="p">(</span><span class="n">L_J</span> <span class="o">=</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mf">1e9</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L_J</span><span class="p">])</span> <span class="c1"># yaxis an array of eigenfrequencies</span>

<span class="c1"># Add plot labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L_J (nH)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normal mode frequency (GHz)&#39;</span><span class="p">)</span>

<span class="c1"># show the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_transmon_LC_programmatically_50_0.png" src="../_images/tutorials_transmon_LC_programmatically_50_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../API/API.html" class="btn btn-neutral float-right" title="API documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="transmon_LC_GUI.html" class="btn btn-neutral float-left" title="Using qucat with the graphical circuit editor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Mario Gely

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>